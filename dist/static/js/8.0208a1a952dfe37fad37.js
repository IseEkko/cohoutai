webpackJsonp([8],{"Gpb+":function(t,e,r){"use strict";var a=r("woOf"),o=r.n(a),n=r("bOdI"),i=r.n(n),s=r("MMfn"),u={is_tab:"",icon:"",keywords:"",name:"",navStatus:0,parentId:0,productUnit:"",showStatus:0,productAttributeIdList:[]},c={name:"ProductCateDetail",components:{SingleUpload:r("TZVV").a},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t;return t={productCate:{},selectProductCateList:[]},i()(t,"selectProductCateList",[]),i()(t,"productCateInfo",{}),i()(t,"defaultCate",[{id:0,name:"无此级分类"}]),i()(t,"rules",{name:[{required:!0,message:"请输入品牌名称",trigger:"blur"}],is_tab:[{required:!0,message:"请选择是否显示在导航栏",trigger:"blur"}]}),i()(t,"filterAttrs",[]),i()(t,"filterProductAttrList",[{value:[]}]),t},created:function(){var t=this;Object(s.q)().then(function(e){t.productCate=t.defaultCate.concat(e)}),this.isEdit&&Object(s.p)(this.$route.query.id).then(function(e){t.productCateInfo=e})},methods:{getProductAttrCateList:function(){var t=this;fetchListWithAttr().then(function(e){for(var r=e.data,a=0;a<r.length;a++){var o=r[a],n=[];if(null!=o.productAttributeList&&o.productAttributeList.length>0)for(var i=0;i<o.productAttributeList.length;i++)n.push({label:o.productAttributeList[i].name,value:o.productAttributeList[i].id});t.filterAttrs.push({label:o.name,value:o.id,children:n})}})},chooseCateFirst:function(){var t=this;console.log(this.productCateInfo.parent_first),this.productCate.forEach(function(e){console.log(t.productCateInfo.parent_first,e),t.productCateInfo.parent_first==e.id&&(t.selectProductCateList=t.defaultCate.concat(e.sub_category))}),console.log(this.selectProductCateList)},getProductAttributeIdList:function(){for(var t=[],e=0;e<this.filterProductAttrList.length;e++){var r=this.filterProductAttrList[e];null!==r.value&&2===r.value.length&&t.push(r.value[1])}return t},onSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return e.$message({message:"验证失败",type:"error",duration:1e3}),!1;e.$confirm("是否提交数据","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.productCateInfo.parent_second?(e.productCateInfo.level=3,e.productCateInfo.parent=e.productCateInfo.parent_second,delete e.productCateInfo.parent_second):e.productCateInfo.parent_first&&!e.productCateInfo.parent_second?(e.productCateInfo.parent=e.productCateInfo.parent_first,delete e.productCateInfo.parent_first,e.productCateInfo.level=2):e.productCateInfo.level=1;var t=e.productCateInfo,r={name:t.name,parent:t.parent,level:t.level,is_tab:t.is_tab};e.isEdit?(e.productCate.productAttributeIdList=e.getProductAttributeIdList(),Object(s.E)(e.$route.query.id,r).then(function(t){e.$message({message:"修改成功",type:"success",duration:1e3}),e.$router.back()})):Object(s.A)(r).then(function(t){e.$message({message:"提交成功",type:"success",duration:1e3}),e.$router.push("/productCate")})})})},resetForm:function(t){this.$refs[t].resetFields(),this.productCate=o()({},u),this.getSelectProductCateList(),this.filterProductAttrList=[{value:[]}]},removeFilterAttr:function(t){if(1!==this.filterProductAttrList.length){var e=this.filterProductAttrList.indexOf(t);-1!==e&&this.filterProductAttrList.splice(e,1)}else this.$message({message:"至少要留一个",type:"warning",duration:1e3})},handleAddFilterAttr:function(){3!==this.filterProductAttrList.length?this.filterProductAttrList.push({value:null,key:Date.now()}):this.$message({message:"最多添加三个",type:"warning",duration:1e3})}},filters:{filterLabelFilter:function(t){return 0===t?"筛选属性：":""}}},l={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-card",{staticClass:"form-container",attrs:{shadow:"never"}},[r("el-form",{ref:"productCateFrom",attrs:{model:t.productCateInfo,rules:t.rules,"label-width":"150px"}},[r("el-form-item",{attrs:{label:"分类名称：",prop:"name"}},[r("el-input",{model:{value:t.productCateInfo.name,callback:function(e){t.$set(t.productCateInfo,"name",e)},expression:"productCateInfo.name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"上级分类："}},[r("el-select",{attrs:{placeholder:"请选择第一级分类"},on:{change:function(e){t.chooseCateFirst()}},model:{value:t.productCateInfo.parent_first,callback:function(e){t.$set(t.productCateInfo,"parent_first",e)},expression:"productCateInfo.parent_first"}},t._l(t.productCate,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),t._v(" "),t.selectProductCateList.length>0?r("el-select",{attrs:{placeholder:"请选择二级分类"},model:{value:t.productCateInfo.parent_second,callback:function(e){t.$set(t.productCateInfo,"parent_second",e)},expression:"productCateInfo.parent_second"}},t._l(t.selectProductCateList,function(t){return r("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})):t._e()],1),t._v(" "),r("el-form-item",{attrs:{label:"是否显示在导航栏："}},[r("el-radio-group",{model:{value:t.productCateInfo.is_tab,callback:function(e){t.$set(t.productCateInfo,"is_tab",e)},expression:"productCateInfo.is_tab"}},[r("el-radio",{attrs:{label:!0}},[t._v("是")]),t._v(" "),r("el-radio",{attrs:{label:!1}},[t._v("否")])],1)],1),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.onSubmit("productCateFrom")}}},[t._v("提交")]),t._v(" "),t.isEdit?t._e():r("el-button",{on:{click:function(e){t.resetForm("productCateFrom")}}},[t._v("重置")])],1)],1)],1)},staticRenderFns:[]};var d=r("VU/8")(c,l,!1,function(t){r("R/Er")},"data-v-2bc09860",null);e.a=d.exports},"R/Er":function(t,e){},"akF+":function(t,e){},"tU/9":function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"addProductCate",components:{ProductCateDetail:r("Gpb+").a}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("product-cate-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]};var n=r("VU/8")(a,o,!1,function(t){r("akF+")},null,null);e.default=n.exports}});
//# sourceMappingURL=8.0208a1a952dfe37fad37.js.map